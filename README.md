# Project 7 - WordPress Pentesting

Time spent: **6** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. WordPress 3.3-4.7.4 - Large File Upload Error XSS
  - [ ] Summary: 
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
  - [ ] GIF Walkthrough: 
    ![FileLarge](./gifs/fileSizeXSS.gif)
  - [ ] Steps to recreate: 
    - Create a file that is above the size of 2 MB
    - Change the name of the file to "Something<img src=x onerror=alert(document.cookie)>" (The code that you want to run should be placed after onerror=)
    - If the admin attempts to upload the file to the page the script will be run
  - [ ] Affected source code:
    - [File Upload Size Rejection Commit](https://github.com/WordPress/WordPress/commit/8c7ea71edbbffca5d9766b7bea7c7f3722ffafa6)

2. WordPress <= 4.2.2 - Authenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary: 
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.3
  - [ ] GIF Walkthrough: 
    ![comment](./gifs/commentXSS.gif)
  - [ ] Steps to recreate: 
    - If the admin of the page is convinced to post a comment with the code "<svg/onload=alert(document.cookie)/>" the code will be run every time the page is loaded.
  - [ ] Affected source code:
    - [Comments](https://core.trac.wordpress.org/changeset/32307/branches/4.2/tests/phpunit/tests/comment.php?old=31615&old_path=trunk%2Ftests%2Fphpunit%2Ftests%2Fcomment.php)

3. Unauthenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary: 
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
  - [ ] GIF Walkthrough: 
   ![unAuth](./gifs/unAuthXSS.gif)
  - [ ] Steps to recreate: 
    - A user needs to register on the page and post at least one comment that gets approved
    - After this point all of their comments will be automatically approved and posted
    - The user now can post a comment containg code and then a string of 'A's that will overload the comment size
    - Once the admin visits the page again the code will run
  - [ ] Affected source code:
    - [Comments](https://core.trac.wordpress.org/changeset/32307/branches/4.2/tests/phpunit/tests/comment.php?old=31615&old_path=trunk%2Ftests%2Fphpunit%2Ftests%2Fcomment.php)

## Assets

List any additional assets, such as scripts or files

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

Some challenges I faced during the project involved getting the VM to run correctly. When the vm was first created it would not let me create any new pages or posts. To fix this I changed the version of wordpress to 4.2 and force restarted the program. Another error I had was making sure that the correct upload technique for the image attack. For example, the attack only works properly when the image is uploaded dirctly to a page or post. If the image is uploaded to media storage the attack will not be run.

## License

    Copyright [2018] [Jacob Fullerton]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
